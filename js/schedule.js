(function(){const e={orderBy:"startTime",showLocation:false,offsetMax:72,offsetMin:4,showDeleted:false,singleEvents:true,maxResults:250};Object.assign(e,CONFIG.calendar);const t=new Date;const n=new Date;const s=new Date;n.setHours(t.getHours()+e.offsetMax);s.setHours(t.getHours()-e.offsetMin);const a={key:e.api_key,orderBy:e.orderBy,timeMax:n.toISOString(),timeMin:s.toISOString(),showDeleted:e.showDeleted,singleEvents:e.singleEvents,maxResults:e.maxResults};const o=new URL(`https://www.googleapis.com/calendar/v3/calendars/${e.calendar_id}/events`);Object.entries(a).forEach((e=>o.searchParams.append(...e)));function r(e,t){const n=60*1e3;const s=n*60;const a=s*24;const o=a*30;const r=a*365;let i=e-t;const c=i>0?" ago":" later";i=Math.abs(i);if(i<s){return Math.round(i/n)+" minutes"+c}else if(i<a){return Math.round(i/s)+" hours"+c}else if(i<o){return"about "+Math.round(i/a)+" days"+c}else if(i<r){return"about "+Math.round(i/o)+" months"+c}return"about "+Math.round(i/r)+" years"+c}function i(n,s,a,o){const i={weekday:"short",hour:"2-digit",minute:"2-digit"};const c=n==="now"?"NOW":r(t,a);const l=a.toLocaleTimeString([],i)+" - "+o.toLocaleTimeString([],i);let d="";if(e.showLocation&&s.location){d=`<span class="event-location event-details">${s.location}</span>`}let u="";if(s.description){u=`<span class="event-description event-details">${s.description}</span>`}const f=`<section class="event event-${n}">\n        <h2 class="event-summary">\n          ${s.summary}\n          <span class="event-relative-time">${c}</span>\n        </h2>\n        ${d}\n        <span class="event-duration event-details">${l}</span>\n        ${u}\n      </section>`;return f}function c(){const e=document.querySelector(".event-list");if(!e)return;fetch(o.href).then((e=>e.json())).then((n=>{if(n.items.length===0){e.innerHTML="<hr>";return}e.innerHTML="";let s=0;const a=(new Date).getTimezoneOffset()*6e4;n.items.forEach((n=>{const o=new Date(n.start.dateTime||new Date(n.start.date).getTime()+a);const r=new Date(n.end.dateTime||new Date(n.end.date).getTime()+a);let c="now";if(r<t){c="past"}else if(o>t){c="future"}if(c==="future"&&s<t){e.insertAdjacentHTML("beforeend","<hr>")}e.insertAdjacentHTML("beforeend",i(c,n,o,r));s=r}))}))}c();const l=setInterval(c,6e4);document.addEventListener("pjax:send",(()=>{clearInterval(l)}))})();